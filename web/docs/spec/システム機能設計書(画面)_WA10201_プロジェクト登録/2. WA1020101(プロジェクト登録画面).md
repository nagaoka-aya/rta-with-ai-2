# WA10201/プロジェクト登録

## 基本情報

| 項目 | 内容 |
|------|------|
| 作成 | TIS (2019/05/13) |
| 変更 | TIS (2022/12/13) |
| システム名 | サンプルシステム |
| サブシステム名 | プロジェクト管理システム |

## 2. WA1020101(プロジェクト登録画面)

### 2.1. 画面レイアウト

*(レイアウト情報は省略)*

### 2.2. 一覧表示

| No. | 領域名 | ページング有無 | ソート条件 | 備考 |
|-----|---------|---------------|------------|-------|
| 1 | - | - | - | - |

### 2.3. 画面項目定義

#### 領域名：プロジェクト情報入力

| No. | 画面項目名 | 画面項目種別 | 情報取得元 | 編集仕様 | 初期値 | 必須 | ドメイン名 | 画面項目名(物理) |
|-----|------------|--------------|------------|----------|---------|------|------------|------------------|
| 1 | 事業部 | select(pulldown) | - | - | - | ○ | 組織ID | divisionId |
| 2 | 部門 | select(pulldown) | - | - | - | ○ | 組織ID | organizationId |
| 3 | PJ名 | text | - | - | - | ○ | プロジェクト名 | projectName |
| 4 | PJ種別 | select(pulldown) | - | コード値取得情報:<br>コードID：C0200001<br>コード名称：プロジェクト種別<br>コードパターン：1<br>表示名称：コード値名称<br>選択なしのオプション：なし | - | ○ | プロジェクト種別 | projectType |
| 5 | PJ分類 | radio | - | コード値取得情報:<br>コードID：C0300001<br>コード名称：プロジェクト分類<br>コードパターン：1<br>表示名称：コード値名称<br>選択なしのオプション：なし | - | ○ | プロジェクト分類 | projectClass |
| 6 | 売上高(千円) | text | - | - | - | - | 金額 | sales |
| 7 | 顧客 | label | - | 顧客検索画面で選択した顧客の顧客名 | - | ○ | 顧客ID | clientId |
| 8 | PM | text | - | - | - | ○ | ユーザ氏名（漢字） | projectManager |
| 9 | PL | text | - | - | - | ○ | ユーザ氏名（漢字） | projectLeader |
| 10 | 開始日 | calendar | - | 表示変換:日付変換<br>yyyy/MM/dd | - | ○ | 日付 | projectStartDate |
| 11 | 終了日 | calendar | - | 表示変換:日付変換<br>yyyy/MM/dd | - | ○ | 日付 | projectEndDate |
| 12 | 備考 | textarea | - | - | - | - | 備考 | note |

### 2.4. 入出力一覧

| No. | 入出力名 | 種別 | I/O | DBアクセス種別 | 備考 |
|-----|---------|------|-----|--------------|------|
| | | | | C | R | U | D | ﾛｯｸ対象 | |
| 1 | 組織 | テーブル | I | - | ○ | - | - | - | - |

### 2.5. 画面イベント一覧

| No. | 画面イベント名 | 発生タイミング | 画面イベント概要 | 正常時遷移先画面 | サーバ通信有無 |
|-----|--------------|--------------|---------------|---------------|-------------|
| 1 | 初期表示 | ‐ | プロジェクト登録画面を表示する。 | - | あり(同期) |
| 2 | 部門リスト取得 | 「事業部」プルダウン選択 | 選択された事業部をもとに、配下部門リストを「部門」プルダウンに設定する。 | - | あり(非同期) |
| 3 | 顧客検索 | 「顧客選択」ボタン押下 | 顧客検索画面を開く。 | 顧客検索画面 | あり(同期) |
| 4 | 確認 | 「確認」ボタン押下 | 入力内容のバリデーション処理を行い、プロジェクト登録確認を表示する。 | プロジェクト登録確認 | あり(同期) |

### 2.6. 画面イベント詳細

#### 2.6.1. 初期表示イベント

##### (1) バリデーション処理

なし。

##### (2) DBアクセス（検索処理）

###### (a) 組織検索条件

| 取得テーブル名 | 取得カラム名 |
|--------------|------------|
| 組織 | 組織ID |
|      | 組織名 |

**検索条件**

| 項目 | 条件 | 値 |
|------|------|-----|
| 組織.上位組織ID | = | NULL |

##### (3) 表示処理

###### (a)「事業部」プルダウンを初期化する。
- 「(2) 検索処理」の検索結果の先頭にブランクオプションを追加して、「事業部」に設定する。
- プルダウンの表示項目には組織名を、値には組織IDを使用する。

#### 2.6.2. 部門リスト取得イベント

##### (1) バリデーション処理

なし。

##### (2) DBアクセス（検索処理）

###### (a) 組織検索条件

| 取得テーブル名 | 取得カラム名 |
|--------------|------------|
| 組織 | 組織ID |
|      | 組織名 |

**検索条件**

| 項目 | 条件 | 値 |
|------|------|-----|
| 組織.上位組織ID | = | 事業部（入力値） |

##### (3) 表示処理

###### (a)「部門」プルダウンを初期化する。
- 「(2) 検索処理」の検索結果の先頭にブランクオプションを追加して、「部門」に設定する。
- プルダウンの表示項目には組織名を、値には組織IDを使用する。

#### 2.6.3. 顧客検索イベント

##### (1) バリデーション処理

なし。

##### (2) 表示処理

顧客検索画面をポップアップ画面として開く。

#### 2.6.4. 確認イベント

##### (1) バリデーション処理

| No. | バリデーション名 | バリデーション内容 | メッセージID | 埋め込み文字列 | エラー発生時のバリデーション処理継続判定 |
|-----|---------------|-----------------|------------|------------|------------------------|
| 1 | 単項目バリデーション | 全ての入力項目に対して、指定ドメインに応じたバリデーションおよび必須チェックを実施し、入力内容の妥当性を確認する。 | （ドメイン別） | （ドメイン別） | 終了する |
| 2 | 日付大小関係 | 「プロジェクト開始日付」と「プロジェクト終了日付」が両方入力されている場合、「プロジェクト開始日付」≦「プロジェクト終了日付」であること。 | validator.periodConsistencyCheck.message.ProjectCreateForm | なし | 終了する |

上記バリデーションにおいて一箇所でもエラーが発生した場合、後続の処理は実施しない。

##### (2) DBアクセス（検索処理）

###### (a) 組織検索条件

Formの事業部、部門には登録画面で選択された組織の組織IDが設定されている。
画面には組織IDに対する組織名を表示する必要があるので、下記クエリにより組織名を取得する。

| 取得テーブル名 | 取得カラム名 |
|--------------|------------|
| 組織 | 組織名 |

**検索条件**

| 項目 | 条件 | 値 |
|------|------|-----|
| 組織.組織ID | = | 組織ID(Formから取得した組織ID) |

###### (b) 顧客情報取得

Formに設定された顧客IDをパラメータとして、顧客管理システム．顧客詳細取得APIを実行し顧客名を取得する。

##### (3) 表示処理

登録画面に入力した内容を登録確認画面に表示する。画面レイアウト、表示項目については「3. プロジェクト登録確認画面」を参照。