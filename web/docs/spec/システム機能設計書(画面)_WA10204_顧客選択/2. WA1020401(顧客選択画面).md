# WA10204/顧客選択

## 作成・変更履歴

| 作成・変更 | 担当 | 日付 |  
|------------|------|------|
| 作成 | TIS | 2022/05/06 |
| 変更 | TIS | 2022/12/12 |

## システム情報
- システム名：サンプルシステム
- サブシステム名：プロジェクト管理システム

## 2. WA1020401(顧客選択画面)

### 2.1. 画面レイアウト

### 2.2. 一覧表示

| No. | 領域名 | ページング有無 | ソート条件 | 備考 |
|-----|--------|----------------|------------|-------|
| 1 | - | - | - | - |

### 2.3. 画面項目定義

| No. | 表示情報 | 画面項目種別 | 情報取得元 | 編集仕様 | 初期値 | 必須 | ドメイン名 | 画面項目名（物理） |
|-----|----------|--------------|------------|----------|---------|------|------------|-------------------|
| **領域名：顧客検索** |||||||||
| 1 | 顧客名 | text | - | - | - | - | 顧客名 | clientName |
| 2 | 業種 | select(pulldown) | - | ＜コード値取得情報＞<br>ｺｰﾄﾞID　  ：C0100001<br>ｺｰﾄﾞ名称　：業種分類<br>ｺｰﾄﾞﾊﾟﾀｰﾝ ：1<br>表示名称 ：コード値名称<br>選択なしのオプション ：なし | 業種を選択 | - | 業種コード | industryCode |
| **領域名：顧客選択** |||||||||
| 3 | 顧客数 | label | 顧客検索API | 顧客検索API呼び出し結果の件数を反映 | - | - | - | numberOfClients |
| 4 | 顧客リスト | select(pulldown) | 顧客検索API | 顧客検索API呼び出し結果をプルダウンリストへ反映 | 「検索結果から選択してください。」 | - | - | clientList |

### 2.4. 入出力一覧

| No. | 入出力名 | 種別 | I/O | DBアクセス種別 | 備考 |
|-----|-----------|------|-----|----------------|-------|
| | | | | C | R | U | D | ﾛｯｸ対象 | |
| 1 | - | - | I | - | - | - | - | - | - |

### 2.5. 画面イベント一覧

| No. | 画面イベント名 | 発生タイミング | 画面イベント概要 | 正常時遷移先画面 | サーバ通信有無 |
|-----|----------------|-----------------|------------------|------------------|----------------|
| 1 | 初期表示 | ‐ | 顧客選択画面を表示する。 | - | なし |
| 2 | 顧客検索 | 「検索」ボタン押下 | 顧客検索結果をプルダウンリストへ設定する | - | あり(非同期) |
| 3 | 顧客選択 | 「選択」ボタン押下 | 顧客選択結果を呼び出し元画面へ反映し、サブウィンドウを閉じる | 呼び出し元画面 | なし |

### 2.6. 画面イベント詳細

#### 2.6.1.初期表示イベント

(1) バリデーション処理

なし。

(2)　表示処理

領域名：顧客選択を非表示として、顧客選択画面を表示する。

#### 2.6.2.顧客検索イベント

(1) バリデーション処理

なし。

(2) API呼び出し

(a) 顧客検索

| 呼び出しAPI名 | クエリパラメータ | クエリパラメータ（物理） |
|---------------|------------------|--------------------------|
| B10101_顧客検索 | 顧客名 | clientName |
| | 業種コード | industryCode |

応答伝聞詳細は下記設計書を参照。
- 外部インタフェース設計書_B10101P_顧客検索応答電文_(JSON)
- 外部インタフェース設計書_B19999P_共通エラー応答電文_(JSON)

(3)　表示処理

(a)「顧客リスト」プルダウンに検索結果を反映する。

(b) API呼び出し結果でエラー応答があった場合
- 400エラーの場合：エラーメッセージを画面上に表示する。
- 上記以外の場合：「エラーが発生しました。処理を再度実行してください。」をアラートメッセージとして画面に表示する。

#### 2.6.3. 顧客選択イベント

(1) 表示処理

呼び出し元画面に「顧客リスト」プルダウンで選択している値を返却し、サブウィンドウを閉じる。